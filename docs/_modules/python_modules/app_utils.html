

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>python_modules.app_utils &mdash; Cinnamon Tools  documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/cinnamon-logo.svg"/>
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../_static/css/theme.min.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> Cinnamon Tools
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../includes/00-requirements.html">Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../includes/01-usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../includes/02-development-notes.html">Development notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../includes/03-code-styling.html">Code styling/guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../includes/04-EOL.html"><abbr title="end-of-life">EOL</abbr> ideas/plans</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Cinnamon Tools</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>python_modules.app_utils</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for python_modules.app_utils</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/python3</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;Module with utility functions and classes.</span>

<span class="sd">Attributes</span>
<span class="sd">----------</span>
<span class="sd">all_xlets_meta_file : str</span>
<span class="sd">    Path to the file generated by :any:`generate_meta_file`.</span>
<span class="sd">docs_sources_path : str</span>
<span class="sd">    Path to the documentation source.</span>
<span class="sd">domain_storage_file : str</span>
<span class="sd">    Path to the file were the domain name for xlets is stored.</span>
<span class="sd">existent_xlet_destination_msg : str</span>
<span class="sd">    Message to display when creating a new xlet and that xlet already exists.</span>
<span class="sd">extra_common_files : list</span>
<span class="sd">    List of files common to all xlets.</span>
<span class="sd">ignored_apidoc_modules : list</span>
<span class="sd">    List of paths to modules to ignore docstrings extraction.</span>
<span class="sd">missing_domain_msg : str</span>
<span class="sd">    Message to display when the domain name isn&#39;t specified at xlet build time.</span>
<span class="sd">missing_theme_name_msg : str</span>
<span class="sd">    Message to display when the theme name isn&#39;t specified at theme build time.</span>
<span class="sd">readme_list_item_template : str</span>
<span class="sd">    Template string to generate help pages list items.</span>
<span class="sd">repo_pages_url : str</span>
<span class="sd">    URL to the repository hosted web pages.</span>
<span class="sd">repo_url : str</span>
<span class="sd">    The repository URL.</span>
<span class="sd">root_folder : str</span>
<span class="sd">    The main folder containing the application. All commands must be executed from this location</span>
<span class="sd">    without exceptions.</span>
<span class="sd">theme_name_storage_file : str</span>
<span class="sd">    Path to the file were the theme name for xlets is stored.</span>
<span class="sd">xlet_dir_ignored_patterns : list</span>
<span class="sd">    List of patterns to ignore while copying files on xlet build time.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">from</span> <span class="nn">shutil</span> <span class="k">import</span> <span class="n">copy2</span><span class="p">,</span> <span class="n">copytree</span><span class="p">,</span> <span class="n">ignore_patterns</span><span class="p">,</span> <span class="n">rmtree</span><span class="p">,</span> <span class="n">which</span>
<span class="kn">from</span> <span class="nn">subprocess</span> <span class="k">import</span> <span class="n">PIPE</span><span class="p">,</span> <span class="n">call</span><span class="p">,</span> <span class="n">STDOUT</span><span class="p">,</span> <span class="n">run</span>

<span class="kn">from</span> <span class="nn">.python_utils</span> <span class="k">import</span> <span class="n">exceptions</span><span class="p">,</span> <span class="n">prompts</span><span class="p">,</span> <span class="n">file_utils</span><span class="p">,</span> <span class="n">misc_utils</span><span class="p">,</span> <span class="n">string_utils</span><span class="p">,</span> <span class="n">shell_utils</span>
<span class="kn">from</span> <span class="nn">.python_utils.ansi_colors</span> <span class="k">import</span> <span class="n">Ansi</span>


<span class="n">root_folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="o">*</span><span class="p">([</span><span class="s2">&quot;..&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">))))))</span>

<span class="n">docs_sources_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root_folder</span><span class="p">,</span> <span class="s2">&quot;__app__&quot;</span><span class="p">,</span> <span class="s2">&quot;docs_sources&quot;</span><span class="p">)</span>

<span class="n">repo_url</span> <span class="o">=</span> <span class="s2">&quot;https://gitlab.com/Odyseus/CinnamonTools&quot;</span>

<span class="n">repo_pages_url</span> <span class="o">=</span> <span class="s2">&quot;https://odyseus.gitlab.io/CinnamonTools&quot;</span>

<span class="n">domain_storage_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root_folder</span><span class="p">,</span> <span class="s2">&quot;domain_name&quot;</span><span class="p">)</span>

<span class="n">theme_name_storage_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root_folder</span><span class="p">,</span> <span class="s2">&quot;theme_name&quot;</span><span class="p">)</span>


<span class="n">all_xlets_meta_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root_folder</span><span class="p">,</span> <span class="s2">&quot;tmp&quot;</span><span class="p">,</span> <span class="s2">&quot;xlets_metadata.json&quot;</span><span class="p">)</span>

<span class="n">missing_domain_msg</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;DomainNameNotSet:</span>

<span class="s2">The command line option `--domain=&lt;domain&gt;` should be used to define a domain</span>
<span class="s2">name for use when building xlets.</span>

<span class="s2">Or a file named &quot;domain_name&quot; should be created at the root of the repository</span>
<span class="s2">whose only content should be the desired domain name.</span>

<span class="s2">The `--domain` command line option has precedence over the domain name found</span>
<span class="s2">inside the &quot;domain_name&quot; file.</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">missing_theme_name_msg</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;ThemeNameNotSet:</span>

<span class="s2">The command line option `--theme-name=&lt;name&gt;` should be used to define a theme</span>
<span class="s2">name for use when building themes.</span>

<span class="s2">Or a file named &quot;theme_name&quot; should be created at the root of the repository</span>
<span class="s2">whose only content should be the desired theme name.</span>

<span class="s2">The `--theme-name` command line option has precedence over the theme name found</span>
<span class="s2">inside the &quot;theme_name&quot; file.</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">existent_xlet_destination_msg</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;Destination folder exists!!!</span>
<span class="si">{path}</span><span class="s2"></span>

<span class="s2">Choosing to proceed will completely remove the existent folder.</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">xlet_dir_ignored_patterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;__pycache__&quot;</span><span class="p">,</span>
    <span class="s2">&quot;__data__&quot;</span><span class="p">,</span>
    <span class="s2">&quot;*~&quot;</span><span class="p">,</span>
    <span class="s2">&quot;*.bak&quot;</span><span class="p">,</span>
    <span class="s2">&quot;*.pyc&quot;</span><span class="p">,</span>
    <span class="s2">&quot;z_config.py&quot;</span><span class="p">,</span>
    <span class="s2">&quot;z_create_localized_help.py&quot;</span><span class="p">,</span>
<span class="p">]</span>

<span class="n">extra_common_files</span> <span class="o">=</span> <span class="p">[{</span>
    <span class="s2">&quot;source_path&quot;</span><span class="p">:</span> <span class="n">root_folder</span><span class="p">,</span>
    <span class="s2">&quot;file_name&quot;</span><span class="p">:</span> <span class="s2">&quot;LICENSE.md&quot;</span><span class="p">,</span>
<span class="p">},</span> <span class="p">{</span>
    <span class="s2">&quot;source_path&quot;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root_folder</span><span class="p">,</span> <span class="s2">&quot;__app__&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="s2">&quot;python_scripts&quot;</span><span class="p">),</span>
    <span class="s2">&quot;file_name&quot;</span><span class="p">:</span> <span class="s2">&quot;helper.py&quot;</span><span class="p">,</span>
<span class="p">}]</span>

<span class="n">readme_list_item_template</span> <span class="o">=</span> <span class="s2">&quot;- [</span><span class="si">{xlet_name}</span><span class="s2">](</span><span class="si">%s</span><span class="s2">/_static/xlets_help_pages/</span><span class="si">{xlet_slug}</span><span class="s2">/index.html)&quot;</span> <span class="o">%</span> <span class="p">(</span>
    <span class="n">repo_pages_url</span><span class="p">)</span>

<span class="n">ignored_apidoc_modules</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;__app__&quot;</span><span class="p">,</span> <span class="s2">&quot;python_modules&quot;</span><span class="p">,</span> <span class="s2">&quot;python_utils&quot;</span><span class="p">,</span> <span class="s2">&quot;bottle.py&quot;</span><span class="p">),</span>
    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;__app__&quot;</span><span class="p">,</span> <span class="s2">&quot;python_modules&quot;</span><span class="p">,</span> <span class="s2">&quot;python_utils&quot;</span><span class="p">,</span> <span class="s2">&quot;docopt.py&quot;</span><span class="p">),</span>
    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;__app__&quot;</span><span class="p">,</span> <span class="s2">&quot;python_modules&quot;</span><span class="p">,</span> <span class="s2">&quot;python_utils&quot;</span><span class="p">,</span> <span class="s2">&quot;mistune.py&quot;</span><span class="p">),</span>
    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;__app__&quot;</span><span class="p">,</span> <span class="s2">&quot;python_modules&quot;</span><span class="p">,</span> <span class="s2">&quot;python_utils&quot;</span><span class="p">,</span> <span class="s2">&quot;polib.py&quot;</span><span class="p">),</span>
    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;__app__&quot;</span><span class="p">,</span> <span class="s2">&quot;python_modules&quot;</span><span class="p">,</span> <span class="s2">&quot;python_utils&quot;</span><span class="p">,</span> <span class="s2">&quot;pyperclip&quot;</span><span class="p">),</span>
    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;__app__&quot;</span><span class="p">,</span> <span class="s2">&quot;python_modules&quot;</span><span class="p">,</span> <span class="s2">&quot;python_utils&quot;</span><span class="p">,</span> <span class="s2">&quot;titlecase.py&quot;</span><span class="p">),</span>
    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;__app__&quot;</span><span class="p">,</span> <span class="s2">&quot;python_modules&quot;</span><span class="p">,</span> <span class="s2">&quot;python_utils&quot;</span><span class="p">,</span> <span class="s2">&quot;tqdm&quot;</span><span class="p">),</span>
    <span class="c1"># The following module has perfectly valid docstrings, but Sphinx is being a</span>
    <span class="c1"># b*tch and throws a million warnings for no reason.</span>
    <span class="c1"># Ignore it until Sphinx gets its sh*t together.</span>
    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;__app__&quot;</span><span class="p">,</span> <span class="s2">&quot;python_modules&quot;</span><span class="p">,</span> <span class="s2">&quot;python_utils&quot;</span><span class="p">,</span> <span class="s2">&quot;tqdm_wget.py&quot;</span><span class="p">),</span>
<span class="p">]</span>


<div class="viewcode-block" id="XletsHelperCore"><a class="viewcode-back" href="../../modules/python_modules/python_modules.app_utils.html#python_modules.app_utils.XletsHelperCore">[docs]</a><span class="k">class</span> <span class="nc">XletsHelperCore</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Xlets core functions.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    logger : object</span>
<span class="sd">        See &lt;class :any:`LogSystem`&gt;.</span>
<span class="sd">    xlets_meta : dict</span>
<span class="sd">        The metadata of all xlets in this repository.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        logger : object</span>
<span class="sd">            See &lt;class :any:`LogSystem`&gt;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">XletsHelperCore</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logger</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xlets_meta</span> <span class="o">=</span> <span class="n">AllXletsMetadata</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">generate_meta_file</span><span class="p">()</span>

<div class="viewcode-block" id="XletsHelperCore.generate_meta_file"><a class="viewcode-back" href="../../modules/python_modules/python_modules.app_utils.html#python_modules.app_utils.XletsHelperCore.generate_meta_file">[docs]</a>    <span class="k">def</span> <span class="nf">generate_meta_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See :any:`generate_meta_file`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">generate_meta_file</span><span class="p">()</span></div>

<div class="viewcode-block" id="XletsHelperCore.create_changelogs"><a class="viewcode-back" href="../../modules/python_modules/python_modules.app_utils.html#python_modules.app_utils.XletsHelperCore.create_changelogs">[docs]</a>    <span class="k">def</span> <span class="nf">create_changelogs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create change logs.</span>

<span class="sd">        Generate the CHANGELOG.md files for all xlets.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.</span> <span class="k">import</span> <span class="n">changelog_handler</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Generating change logs...&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">xlet</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlets_meta</span><span class="o">.</span><span class="n">meta_list</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Generating change log for </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">xlet</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">xlet_root_folder</span> <span class="o">=</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">get_parent_dir</span><span class="p">(</span><span class="n">xlet</span><span class="p">[</span><span class="s2">&quot;meta-path&quot;</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
                <span class="n">log_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">xlet_root_folder</span><span class="p">,</span> <span class="s2">&quot;__data__&quot;</span><span class="p">,</span> <span class="s2">&quot;CHANGELOG.md&quot;</span><span class="p">)</span>
                <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">log_path</span><span class="p">),</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">log_path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">changelog_handler</span><span class="o">.</span><span class="n">CHANGELOG_HEADER</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="n">xlet_name</span><span class="o">=</span><span class="n">xlet</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span>
                        <span class="n">repo_url</span><span class="o">=</span><span class="n">repo_url</span>
                    <span class="p">))</span>

                <span class="c1"># Generate change log from current repository paths.</span>
                <span class="n">relative_xlet_path</span> <span class="o">=</span> <span class="s2">&quot;./&quot;</span> <span class="o">+</span> <span class="n">xlet</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;s/&quot;</span> <span class="o">+</span> <span class="n">xlet</span><span class="p">[</span><span class="s2">&quot;slug&quot;</span><span class="p">]</span>
                <span class="n">cmd</span> <span class="o">=</span> <span class="n">changelog_handler</span><span class="o">.</span><span class="n">git_log_cmd</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">xlet_slug</span><span class="o">=</span><span class="n">xlet</span><span class="p">[</span><span class="s2">&quot;slug&quot;</span><span class="p">],</span>
                    <span class="n">relative_xlet_path</span><span class="o">=</span><span class="n">relative_xlet_path</span><span class="p">,</span>
                    <span class="n">append_or_override</span><span class="o">=</span><span class="s2">&quot;&gt;&gt;&quot;</span><span class="p">,</span>
                    <span class="n">log_path</span><span class="o">=</span><span class="n">log_path</span><span class="p">,</span>
                    <span class="n">repo_url</span><span class="o">=</span><span class="n">repo_url</span>
                <span class="p">)</span>
                <span class="n">call</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">cwd</span><span class="o">=</span><span class="n">root_folder</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">err</span><span class="p">)</span></div>

<div class="viewcode-block" id="XletsHelperCore.update_pot_files"><a class="viewcode-back" href="../../modules/python_modules/python_modules.app_utils.html#python_modules.app_utils.XletsHelperCore.update_pot_files">[docs]</a>    <span class="k">def</span> <span class="nf">update_pot_files</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update POT files.</span>

<span class="sd">        Update all .pot files from all xlets.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        SystemExit</span>
<span class="sd">            Halt execution if the make-cinnamon-xlet-pot-app command is not found.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Starting POT files update...&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">xlet</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlets_meta</span><span class="o">.</span><span class="n">meta_list</span><span class="p">:</span>
            <span class="n">xlet_root_folder</span> <span class="o">=</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">get_parent_dir</span><span class="p">(</span><span class="n">xlet</span><span class="p">[</span><span class="s2">&quot;meta-path&quot;</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="s2">&quot;Updating localization template for </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">xlet</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">which</span><span class="p">(</span><span class="s2">&quot;make-cinnamon-xlet-pot-app&quot;</span><span class="p">):</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">Ansi</span><span class="o">.</span><span class="n">ERROR</span><span class="p">(</span><span class="s2">&quot;MissingCommand: make-cinnamon-xlet-pot-app command not found!!!&quot;</span><span class="p">))</span>
                    <span class="k">raise</span> <span class="ne">SystemExit</span><span class="p">()</span>

                <span class="n">cmd</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="s2">&quot;make-cinnamon-xlet-pot-app&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;--custom-header&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;--scan-additional-file=../../__app__/python_modules/localized_help_creator.py&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;--ignored-pattern=__data__/*&quot;</span>
                <span class="p">]</span>
                <span class="n">call</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">cwd</span><span class="o">=</span><span class="n">xlet_root_folder</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">continue</span></div>

<div class="viewcode-block" id="XletsHelperCore.create_localized_help"><a class="viewcode-back" href="../../modules/python_modules/python_modules.app_utils.html#python_modules.app_utils.XletsHelperCore.create_localized_help">[docs]</a>    <span class="k">def</span> <span class="nf">create_localized_help</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create localized help.</span>

<span class="sd">        Execute the z_create_localized_help.py script for each xlet to generate their</span>
<span class="sd">        HELP.html files.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Starting localized help creation...&quot;</span><span class="p">)</span>

        <span class="n">applets_list_items</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">extensions_list_items</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">xlet</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlets_meta</span><span class="o">.</span><span class="n">meta_list</span><span class="p">:</span>
            <span class="n">xlet_root_folder</span> <span class="o">=</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">get_parent_dir</span><span class="p">(</span><span class="n">xlet</span><span class="p">[</span><span class="s2">&quot;meta-path&quot;</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">script_file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">xlet_root_folder</span><span class="p">,</span> <span class="s2">&quot;z_create_localized_help.py&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">script_file_path</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Creating localized help for </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">xlet</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span>
                <span class="n">call</span><span class="p">([</span><span class="n">script_file_path</span><span class="p">],</span> <span class="n">cwd</span><span class="o">=</span><span class="n">xlet_root_folder</span><span class="p">)</span>

                <span class="c1"># Store list items for later creating the README.md file.</span>
                <span class="n">list_item</span> <span class="o">=</span> <span class="n">readme_list_item_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">xlet_name</span><span class="o">=</span><span class="n">xlet</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span>
                    <span class="n">xlet_slug</span><span class="o">=</span><span class="n">xlet</span><span class="p">[</span><span class="s2">&quot;slug&quot;</span><span class="p">]</span>
                <span class="p">)</span>

                <span class="k">if</span> <span class="n">xlet</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;applet&quot;</span><span class="p">:</span>
                    <span class="n">applets_list_items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">list_item</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">xlet</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;extension&quot;</span><span class="p">:</span>
                    <span class="n">extensions_list_items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">list_item</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Generating repository README.md file...&quot;</span><span class="p">)</span>

        <span class="n">readme_template_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root_folder</span><span class="p">,</span> <span class="s2">&quot;__app__&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">,</span>
                                            <span class="s2">&quot;templates&quot;</span><span class="p">,</span> <span class="s2">&quot;README.md&quot;</span><span class="p">)</span>
        <span class="n">readme_file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root_folder</span><span class="p">,</span> <span class="s2">&quot;README.md&quot;</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">readme_template_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;UTF-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">readme_template</span><span class="p">:</span>
            <span class="n">template</span> <span class="o">=</span> <span class="n">readme_template</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">readme_file_path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;UTF-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">readme_file</span><span class="p">:</span>
                <span class="n">readme_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">applets_help_pages</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">applets_list_items</span><span class="p">)),</span>
                    <span class="n">extensions_help_pages</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">extensions_list_items</span><span class="p">)),</span>
                    <span class="n">repo_url</span><span class="o">=</span><span class="n">repo_url</span><span class="p">,</span>
                    <span class="n">repo_pages_url</span><span class="o">=</span><span class="n">repo_pages_url</span>
                <span class="p">))</span></div>

<div class="viewcode-block" id="XletsHelperCore.generate_trans_stats"><a class="viewcode-back" href="../../modules/python_modules/python_modules.app_utils.html#python_modules.app_utils.XletsHelperCore.generate_trans_stats">[docs]</a>    <span class="k">def</span> <span class="nf">generate_trans_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generate translations statistics.</span>

<span class="sd">        Generates files that contain the amount of untranslated strings an xlet has.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        SystemExit</span>
<span class="sd">            Halt execution if the msgmerge command is not found.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Generating translation statistics...&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">which</span><span class="p">(</span><span class="s2">&quot;msgmerge&quot;</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">Ansi</span><span class="o">.</span><span class="n">ERROR</span><span class="p">(</span><span class="s2">&quot;MissingCommand: msgmerge command not found!!!&quot;</span><span class="p">))</span>
            <span class="k">raise</span> <span class="ne">SystemExit</span><span class="p">()</span>

        <span class="n">markdown_content</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">po_tmp_storage</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root_folder</span><span class="p">,</span> <span class="s2">&quot;tmp&quot;</span><span class="p">,</span> <span class="s2">&quot;po_files_updated&quot;</span><span class="p">)</span>
        <span class="n">trans_stats_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="n">root_folder</span><span class="p">,</span> <span class="s2">&quot;tmp&quot;</span><span class="p">,</span> <span class="s2">&quot;po_files_untranslated_table.md&quot;</span><span class="p">)</span>
        <span class="n">rmtree</span><span class="p">(</span><span class="n">po_tmp_storage</span><span class="p">,</span> <span class="n">ignore_errors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">po_tmp_storage</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">xlet</span> <span class="ow">in</span> <span class="n">get_xlets_dirs</span><span class="p">():</span>
            <span class="n">xlet_type</span><span class="p">,</span> <span class="n">xlet_dir_name</span> <span class="o">=</span> <span class="n">xlet</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
            <span class="n">xlet_po_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="n">root_folder</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">s&quot;</span> <span class="o">%</span> <span class="n">xlet_type</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">xlet_dir_name</span><span class="p">,</span> <span class="s2">&quot;po&quot;</span><span class="p">)</span>
            <span class="n">tmp_xlet_po_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="n">po_tmp_storage</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">s&quot;</span> <span class="o">%</span> <span class="n">xlet_type</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">xlet_dir_name</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">tmp_xlet_po_dir</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">xlet_po_dir</span><span class="p">):</span>
                <span class="n">xlet_po_list</span> <span class="o">=</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">recursive_glob</span><span class="p">(</span><span class="n">xlet_po_dir</span><span class="p">,</span> <span class="s2">&quot;*.po&quot;</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">xlet_po_list</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span>
                                     <span class="p">(</span><span class="n">xlet_type</span><span class="p">,</span> <span class="n">xlet_dir_name</span><span class="p">),</span> <span class="n">date</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                    <span class="n">markdown_content</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">### </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span>
                        <span class="n">xlet_type</span><span class="p">,</span> <span class="n">xlet_dir_name</span><span class="p">)</span>
                    <span class="n">markdown_content</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="n">markdown_content</span> <span class="o">+=</span> <span class="s2">&quot;|LANGUAGE|UNTRANSLATED|</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="n">markdown_content</span> <span class="o">+=</span> <span class="s2">&quot;|--------|------------|</span><span class="se">\n</span><span class="s2">&quot;</span>

                    <span class="k">for</span> <span class="n">po_file_path</span> <span class="ow">in</span> <span class="n">xlet_po_list</span><span class="p">:</span>
                        <span class="n">po_base_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">po_file_path</span><span class="p">)</span>
                        <span class="n">tmp_po_file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tmp_xlet_po_dir</span><span class="p">,</span> <span class="n">po_base_name</span><span class="p">)</span>
                        <span class="n">tmp_pot_file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">xlet_po_dir</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.pot&quot;</span> <span class="o">%</span> <span class="n">xlet_dir_name</span><span class="p">)</span>

                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Copying </span><span class="si">%s</span><span class="s2"> to temporary location...&quot;</span> <span class="o">%</span>
                                         <span class="n">po_base_name</span><span class="p">,</span> <span class="n">date</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                        <span class="n">copy2</span><span class="p">(</span><span class="n">po_file_path</span><span class="p">,</span> <span class="n">tmp_po_file_path</span><span class="p">)</span>

                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Updating temporary </span><span class="si">%s</span><span class="s2"> from localization template...&quot;</span> <span class="o">%</span>
                                         <span class="n">po_base_name</span><span class="p">,</span> <span class="n">date</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                        <span class="n">call</span><span class="p">([</span>
                            <span class="s2">&quot;msgmerge&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;--no-fuzzy-matching&quot;</span><span class="p">,</span>  <span class="c1"># Do not use fuzzy matching.</span>
                            <span class="s2">&quot;--previous&quot;</span><span class="p">,</span>           <span class="c1"># Keep previous msgids of translated messages.</span>
                            <span class="s2">&quot;--backup=off&quot;</span><span class="p">,</span>         <span class="c1"># Never make backups.</span>
                            <span class="s2">&quot;--update&quot;</span><span class="p">,</span>             <span class="c1"># Update .po file, do nothing if up to date.</span>
                            <span class="n">tmp_po_file_path</span><span class="p">,</span>       <span class="c1"># The .po file to update.</span>
                            <span class="n">tmp_pot_file_path</span>       <span class="c1"># The template file to update from.</span>
                        <span class="p">])</span>

                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Counting untranslated strings...&quot;</span><span class="p">,</span> <span class="n">date</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                        <span class="n">trans_count_cmd</span> <span class="o">=</span> <span class="s1">&#39;msggrep -v -T -e &quot;.&quot; &quot;</span><span class="si">%s</span><span class="s1">&quot; | grep -c ^msgstr&#39;</span>
                        <span class="n">trans_count_output</span> <span class="o">=</span> <span class="n">run</span><span class="p">(</span><span class="n">trans_count_cmd</span> <span class="o">%</span> <span class="n">tmp_po_file_path</span><span class="p">,</span>
                                                 <span class="n">stderr</span><span class="o">=</span><span class="n">STDOUT</span><span class="p">,</span>
                                                 <span class="n">stdout</span><span class="o">=</span><span class="n">PIPE</span><span class="p">,</span>
                                                 <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">stdout</span>
                        <span class="n">trans_count</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">trans_count_output</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;UTF-8&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
                        <span class="n">markdown_content</span> <span class="o">+=</span> <span class="s2">&quot;|</span><span class="si">%s</span><span class="s2">|</span><span class="si">%s</span><span class="s2">|</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">po_base_name</span><span class="p">,</span> <span class="n">trans_count</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">markdown_content</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">trans_stats_file</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;UTF-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">trans_file</span><span class="p">:</span>
                <span class="n">trans_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">markdown_content</span><span class="p">)</span></div>

<div class="viewcode-block" id="XletsHelperCore.update_spanish_localizations"><a class="viewcode-back" href="../../modules/python_modules/python_modules.app_utils.html#python_modules.app_utils.XletsHelperCore.update_spanish_localizations">[docs]</a>    <span class="k">def</span> <span class="nf">update_spanish_localizations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update Spanish localizations.</span>

<span class="sd">        Update all Spanish localizations from all xlets.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        SystemExit</span>
<span class="sd">            Halt execution if the msgmerge command is not found.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Updating Spanish localizations...&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">which</span><span class="p">(</span><span class="s2">&quot;msgmerge&quot;</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">Ansi</span><span class="o">.</span><span class="n">ERROR</span><span class="p">(</span><span class="s2">&quot;MissingCommand: msgmerge command not found!!!&quot;</span><span class="p">))</span>
            <span class="k">raise</span> <span class="ne">SystemExit</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">xlet</span> <span class="ow">in</span> <span class="n">get_xlets_dirs</span><span class="p">():</span>
            <span class="n">xlet_type</span><span class="p">,</span> <span class="n">xlet_dir_name</span> <span class="o">=</span> <span class="n">xlet</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
            <span class="n">po_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root_folder</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">s&quot;</span> <span class="o">%</span>
                                  <span class="n">xlet_type</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">xlet_dir_name</span><span class="p">,</span> <span class="s2">&quot;po&quot;</span><span class="p">)</span>
            <span class="n">po_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">po_dir</span><span class="p">,</span> <span class="s2">&quot;es.po&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">po_dir</span><span class="p">)</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">po_file</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Updating localization for </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">xlet_dir_name</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">call</span><span class="p">([</span>
                    <span class="s2">&quot;msgmerge&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;--no-fuzzy-matching&quot;</span><span class="p">,</span>      <span class="c1"># Do not use fuzzy matching.</span>
                    <span class="s2">&quot;--previous&quot;</span><span class="p">,</span>               <span class="c1"># Keep previous msgids of translated messages.</span>
                    <span class="s2">&quot;--backup=off&quot;</span><span class="p">,</span>             <span class="c1"># Never make backups.</span>
                    <span class="s2">&quot;--update&quot;</span><span class="p">,</span>                 <span class="c1"># Update .po file, do nothing if up to date.</span>
                    <span class="s2">&quot;es.po&quot;</span><span class="p">,</span>                    <span class="c1"># The .po file to update.</span>
                    <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.pot&quot;</span> <span class="o">%</span> <span class="n">xlet_dir_name</span>    <span class="c1"># The template file to update from.</span>
                <span class="p">],</span> <span class="n">cwd</span><span class="o">=</span><span class="n">po_dir</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Something might have gone wrong!&quot;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="AllXletsMetadata"><a class="viewcode-back" href="../../modules/python_modules/python_modules.app_utils.html#python_modules.app_utils.AllXletsMetadata">[docs]</a><span class="k">class</span> <span class="nc">AllXletsMetadata</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;All xlets metadata.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    meta_list : list</span>
<span class="sd">        A list of dictionaries containing all xlets metadata.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialization.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">all_xlets_meta_file</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">Ansi</span><span class="o">.</span><span class="n">WARNING</span><span class="p">(</span><span class="s2">&quot;xlets_metadata.json file not found. It will be generated.&quot;</span><span class="p">))</span>
                <span class="n">generate_meta_file</span><span class="p">()</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">all_xlets_meta_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;UTF-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">xlets_metadata</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">meta_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">xlets_metadata</span><span class="o">.</span><span class="n">read</span><span class="p">()))</span></div>


<div class="viewcode-block" id="generate_meta_file"><a class="viewcode-back" href="../../modules/python_modules/python_modules.app_utils.html#python_modules.app_utils.generate_meta_file">[docs]</a><span class="k">def</span> <span class="nf">generate_meta_file</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Generate the file containing all the metadata of all xlets on this repository.</span>
<span class="sd">    This metadata file is used by several functions on the XletsHelperCore class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">Ansi</span><span class="o">.</span><span class="n">INFO</span><span class="p">(</span><span class="s2">&quot;Generating xlets metadata file...&quot;</span><span class="p">))</span>
    <span class="n">xlet_meta_files</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">xlet_meta</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">dirname</span><span class="p">,</span> <span class="n">dirnames</span><span class="p">,</span> <span class="n">filenames</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root_folder</span><span class="p">,</span> <span class="s2">&quot;applets&quot;</span><span class="p">),</span> <span class="n">topdown</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">filename</span> <span class="o">==</span> <span class="s2">&quot;metadata.json&quot;</span><span class="p">:</span>
                <span class="n">xlet_meta_files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dirname</span><span class="p">,</span> <span class="n">filename</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">dirname</span><span class="p">,</span> <span class="n">dirnames</span><span class="p">,</span> <span class="n">filenames</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root_folder</span><span class="p">,</span> <span class="s2">&quot;extensions&quot;</span><span class="p">),</span> <span class="n">topdown</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">filename</span> <span class="o">==</span> <span class="s2">&quot;metadata.json&quot;</span><span class="p">:</span>
                <span class="n">xlet_meta_files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dirname</span><span class="p">,</span> <span class="n">filename</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">xlet_meta_files</span><span class="p">)):</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">xlet_meta_files</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;UTF-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">xlet_meta_file</span><span class="p">:</span>
            <span class="n">raw_meta</span> <span class="o">=</span> <span class="n">xlet_meta_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
            <span class="n">json_meta</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">raw_meta</span><span class="p">)</span>
            <span class="c1"># Store the path to the metadata.json file so I can use it to create</span>
            <span class="c1"># the different needed paths when needed.</span>
            <span class="c1"># This will allow me to avoid to constantly create a path with</span>
            <span class="c1"># os.path.join in my functions. I will just use the metadata.json path</span>
            <span class="c1"># and &quot;traverse it&quot;.</span>
            <span class="n">json_meta</span><span class="p">[</span><span class="s2">&quot;meta-path&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xlet_meta_files</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">json_meta</span><span class="p">[</span><span class="s2">&quot;slug&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span>
                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">xlet_meta_files</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>

            <span class="k">if</span> <span class="s2">&quot;/applets/&quot;</span> <span class="ow">in</span> <span class="n">xlet_meta_files</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="n">json_meta</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;applet&quot;</span>
            <span class="k">elif</span> <span class="s2">&quot;/extensions/&quot;</span> <span class="ow">in</span> <span class="n">xlet_meta_files</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="n">json_meta</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;extension&quot;</span>

            <span class="n">xlet_meta</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">json_meta</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">all_xlets_meta_file</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;UTF-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
        <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">xlet_meta</span><span class="p">,</span> <span class="n">outfile</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">ensure_ascii</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>


<div class="viewcode-block" id="build_xlets"><a class="viewcode-back" href="../../modules/python_modules/python_modules.app_utils.html#python_modules.app_utils.build_xlets">[docs]</a><span class="k">def</span> <span class="nf">build_xlets</span><span class="p">(</span><span class="n">xlets</span><span class="o">=</span><span class="p">[],</span> <span class="n">domain_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">build_output</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="n">do_not_cofirm</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">from_menu</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Build xlets.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    xlets : list, optional</span>
<span class="sd">        The list of xlets to build.</span>
<span class="sd">    domain_name : None, optional</span>
<span class="sd">        The domain name to use to build the xlets.</span>
<span class="sd">    build_output : str, optional</span>
<span class="sd">        Path to the folder were the built xlets are stored.</span>
<span class="sd">    do_not_cofirm : bool, optional</span>
<span class="sd">        Whether to ask for overwrite confirmation when an xlet destination exists or not.</span>
<span class="sd">    logger : object</span>
<span class="sd">        See &lt;class :any:`LogSystem`&gt;.</span>
<span class="sd">    from_menu : bool, optional</span>
<span class="sd">        Whether this function was called from the CLI menu or not.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    SystemExit</span>
<span class="sd">        Halt execution if the domain name cannot be obtained.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">domain_name</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">domain_storage_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;UTF-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">domain_file</span><span class="p">:</span>
                <span class="n">domain_name</span> <span class="o">=</span> <span class="n">domain_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">Ansi</span><span class="o">.</span><span class="n">WARNING</span><span class="p">(</span><span class="n">missing_domain_msg</span><span class="p">))</span>
            <span class="k">raise</span> <span class="ne">SystemExit</span><span class="p">()</span>

    <span class="c1"># TODO:</span>
    <span class="c1"># Implement a &quot;domain name validator&quot; function.</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">domain_name</span><span class="p">:</span>
        <span class="c1"># Message from the raised exception isn&#39;t printed when this function</span>
        <span class="c1"># is executed from the CLI menu.</span>
        <span class="c1"># So, print the message explicitly.</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">Ansi</span><span class="o">.</span><span class="n">WARNING</span><span class="p">(</span><span class="n">missing_domain_msg</span><span class="p">))</span>
        <span class="k">raise</span> <span class="ne">SystemExit</span><span class="p">()</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">build_output</span><span class="p">:</span>
        <span class="n">base_output_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">get_base_temp_folder</span><span class="p">(),</span>
                                        <span class="n">misc_utils</span><span class="o">.</span><span class="n">micro_to_milli</span><span class="p">(</span><span class="n">misc_utils</span><span class="o">.</span><span class="n">get_date_time</span><span class="p">(</span><span class="s2">&quot;filename&quot;</span><span class="p">)))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">base_output_path</span> <span class="o">=</span> <span class="n">build_output</span>

    <span class="n">all_xlets</span> <span class="o">=</span> <span class="n">get_xlets_dirs</span><span class="p">()</span>

    <span class="n">xlets_data</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="n">xlets</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xlets</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">all_xlets</span><span class="p">:</span>
                <span class="n">xlet_type</span><span class="p">,</span> <span class="n">xlet_dir_name</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
                <span class="n">uuid</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">@</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">xlet_dir_name</span><span class="p">,</span> <span class="n">domain_name</span><span class="p">)</span>
                <span class="n">xlets_data</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                    <span class="s2">&quot;uuid&quot;</span><span class="p">:</span> <span class="n">uuid</span><span class="p">,</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">xlet_type</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span>
                    <span class="s2">&quot;slug&quot;</span><span class="p">:</span> <span class="n">xlet_dir_name</span><span class="p">,</span>
                    <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root_folder</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">s&quot;</span> <span class="o">%</span> <span class="n">xlet_type</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">xlet_dir_name</span><span class="p">),</span>
                    <span class="s2">&quot;destination&quot;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_output_path</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">s&quot;</span> <span class="o">%</span> <span class="n">xlet_type</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">uuid</span><span class="p">),</span>
                <span class="p">})</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> doesn&#39;t exists.&quot;</span> <span class="o">%</span> <span class="n">x</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">xlets_data</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">xlets_data</span><span class="p">:</span>
            <span class="n">builder</span> <span class="o">=</span> <span class="n">XletBuilder</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">do_not_cofirm</span><span class="p">,</span> <span class="n">logger</span><span class="p">)</span>
            <span class="n">builder</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Built xlets saved in </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">base_output_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="XletBuilder"><a class="viewcode-back" href="../../modules/python_modules/python_modules.app_utils.html#python_modules.app_utils.XletBuilder">[docs]</a><span class="k">class</span> <span class="nc">XletBuilder</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;XletBuilder class.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    config_file : str</span>
<span class="sd">        Path to the file z_config.py inside an xlet folder.</span>
<span class="sd">    do_not_cofirm : bool</span>
<span class="sd">        Whether to ask for overwrite confirmation when an xlet destination exists or not.</span>
<span class="sd">    logger : object</span>
<span class="sd">        See &lt;class :any:`LogSystem`&gt;.</span>
<span class="sd">    replacement_data : list</span>
<span class="sd">        Data used to perform string substitutions. It is a list of tuples with two items.</span>
<span class="sd">    schemas_dir : str</span>
<span class="sd">        Path to the folder schemas inside an xlet folder.</span>
<span class="sd">    xlet_data : dict</span>
<span class="sd">        The xlet data to handle.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xlet_data</span><span class="p">,</span> <span class="n">do_not_cofirm</span><span class="p">,</span> <span class="n">logger</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        xlet_data : dict</span>
<span class="sd">            The xlet data to handle.</span>
<span class="sd">        do_not_cofirm : bool</span>
<span class="sd">            Whether to ask for overwrite confirmation when an xlet destination exists or not.</span>
<span class="sd">        logger : object</span>
<span class="sd">            See &lt;class :any:`LogSystem`&gt;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">XletBuilder</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xlet_data</span> <span class="o">=</span> <span class="n">xlet_data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">do_not_cofirm</span> <span class="o">=</span> <span class="n">do_not_cofirm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logger</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schemas_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">xlet_data</span><span class="p">[</span><span class="s2">&quot;destination&quot;</span><span class="p">],</span> <span class="s2">&quot;schemas&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">xlet_data</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">],</span> <span class="s2">&quot;z_config.py&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">replacement_data</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="s2">&quot;{{UUID}}&quot;</span><span class="p">,</span> <span class="n">xlet_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;uuid&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)),</span>
            <span class="p">(</span><span class="s2">&quot;{{REPO_URL}}&quot;</span><span class="p">,</span> <span class="n">repo_url</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;{{XLET_TYPE}}&quot;</span><span class="p">,</span> <span class="n">xlet_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)),</span>
            <span class="c1"># Yes, include the escaped double quotes to keep the template file without errors.</span>
            <span class="c1"># The replacement data will be a &quot;Python boolean&quot; (True or False).</span>
            <span class="p">(</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">{{XLET_HAS_SCHEMA}}</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;True&quot;</span> <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">schemas_dir</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;False&quot;</span><span class="p">),</span>
        <span class="p">]</span>

<div class="viewcode-block" id="XletBuilder.build"><a class="viewcode-back" href="../../modules/python_modules/python_modules.app_utils.html#python_modules.app_utils.XletBuilder.build">[docs]</a>    <span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Build xlet.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">shell_utils</span><span class="o">.</span><span class="n">get_cli_separator</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">),</span> <span class="n">date</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Building the </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span>
                         <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xlet_data</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlet_data</span><span class="p">[</span><span class="s2">&quot;slug&quot;</span><span class="p">]))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_do_copy</span><span class="p">()</span>
        <span class="n">string_utils</span><span class="o">.</span><span class="n">do_string_substitutions</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xlet_data</span><span class="p">[</span><span class="s2">&quot;destination&quot;</span><span class="p">],</span>
                                             <span class="bp">self</span><span class="o">.</span><span class="n">replacement_data</span><span class="p">,</span>
                                             <span class="n">logger</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_compile_schemas</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_handle_config_file</span><span class="p">()</span></div>

<div class="viewcode-block" id="XletBuilder._do_copy"><a class="viewcode-back" href="../../modules/python_modules/python_modules.app_utils.html#python_modules.app_utils.XletBuilder._do_copy">[docs]</a>    <span class="k">def</span> <span class="nf">_do_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Copy xlet files into its final destination.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        exceptions.InvalidDestination</span>
<span class="sd">            Invalid xlet destination.</span>
<span class="sd">        exceptions.OperationAborted</span>
<span class="sd">            Halt build operation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xlet_data</span><span class="p">[</span><span class="s2">&quot;destination&quot;</span><span class="p">]):</span>
            <span class="k">raise</span> <span class="n">exceptions</span><span class="o">.</span><span class="n">InvalidDestination</span><span class="p">(</span>
                <span class="s2">&quot;Destination exists and is a file!!! Aborted!!!&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xlet_data</span><span class="p">[</span><span class="s2">&quot;destination&quot;</span><span class="p">]):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_not_cofirm</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">Ansi</span><span class="o">.</span><span class="n">WARNING</span><span class="p">(</span><span class="n">existent_xlet_destination_msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xlet_data</span><span class="p">[</span><span class="s2">&quot;destination&quot;</span><span class="p">])))</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_not_cofirm</span> <span class="ow">or</span> <span class="n">prompts</span><span class="o">.</span><span class="n">confirm</span><span class="p">(</span><span class="n">prompt</span><span class="o">=</span><span class="s2">&quot;Proceed?&quot;</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
                <span class="n">rmtree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xlet_data</span><span class="p">[</span><span class="s2">&quot;destination&quot;</span><span class="p">],</span> <span class="n">ignore_errors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">exceptions</span><span class="o">.</span><span class="n">OperationAborted</span><span class="p">(</span><span class="s2">&quot;Building the </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2"> was canceled.&quot;</span> <span class="o">%</span>
                                                  <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xlet_data</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlet_data</span><span class="p">[</span><span class="s2">&quot;slug&quot;</span><span class="p">]))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Copying main xlet files...&quot;</span><span class="p">)</span>
        <span class="n">copytree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xlet_data</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlet_data</span><span class="p">[</span><span class="s2">&quot;destination&quot;</span><span class="p">],</span> <span class="n">symlinks</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">ignore</span><span class="o">=</span><span class="n">ignore_patterns</span><span class="p">(</span><span class="o">*</span><span class="n">xlet_dir_ignored_patterns</span><span class="p">),</span>
                 <span class="n">ignore_dangling_symlinks</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Copying common xlet files...&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">extra</span> <span class="ow">in</span> <span class="n">extra_common_files</span><span class="p">:</span>
            <span class="n">copy2</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">extra</span><span class="p">[</span><span class="s2">&quot;source_path&quot;</span><span class="p">],</span> <span class="n">extra</span><span class="p">[</span><span class="s2">&quot;file_name&quot;</span><span class="p">]),</span>
                  <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xlet_data</span><span class="p">[</span><span class="s2">&quot;destination&quot;</span><span class="p">],</span> <span class="n">extra</span><span class="p">[</span><span class="s2">&quot;file_name&quot;</span><span class="p">]))</span></div>

<div class="viewcode-block" id="XletBuilder._compile_schemas"><a class="viewcode-back" href="../../modules/python_modules/python_modules.app_utils.html#python_modules.app_utils.XletBuilder._compile_schemas">[docs]</a>    <span class="k">def</span> <span class="nf">_compile_schemas</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compile schemas file if any.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">schemas_dir</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Compiling gsettings schema...&quot;</span><span class="p">)</span>
            <span class="n">call</span><span class="p">([</span><span class="s2">&quot;glib-compile-schemas&quot;</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="s2">&quot;--targetdir=.&quot;</span><span class="p">],</span> <span class="n">cwd</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">schemas_dir</span><span class="p">)</span></div>

<div class="viewcode-block" id="XletBuilder._handle_config_file"><a class="viewcode-back" href="../../modules/python_modules/python_modules.app_utils.html#python_modules.app_utils.XletBuilder._handle_config_file">[docs]</a>    <span class="k">def</span> <span class="nf">_handle_config_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Handle xlet configuration file if any.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_file</span><span class="p">):</span>
            <span class="kn">from</span> <span class="nn">runpy</span> <span class="k">import</span> <span class="n">run_path</span>
            <span class="n">extra_settings</span> <span class="o">=</span> <span class="n">run_path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_file</span><span class="p">)[</span><span class="s2">&quot;settings&quot;</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">extra_settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;symlinks&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Generating symbolic links...&quot;</span><span class="p">)</span>

                <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xlet_data</span><span class="p">[</span><span class="s2">&quot;destination&quot;</span><span class="p">])</span>

                <span class="k">for</span> <span class="nb">dir</span> <span class="ow">in</span> <span class="n">extra_settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;symlinks&quot;</span><span class="p">):</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xlet_data</span><span class="p">[</span><span class="s2">&quot;destination&quot;</span><span class="p">],</span> <span class="nb">dir</span><span class="p">),</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

                    <span class="k">for</span> <span class="n">src</span><span class="p">,</span> <span class="n">dst</span> <span class="ow">in</span> <span class="n">extra_settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;symlinks&quot;</span><span class="p">)[</span><span class="nb">dir</span><span class="p">]:</span>
                        <span class="n">os</span><span class="o">.</span><span class="n">symlink</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">dir</span><span class="p">,</span> <span class="n">dst</span><span class="p">))</span>

                <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">root_folder</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="_list_xlets_dirs"><a class="viewcode-back" href="../../modules/python_modules/python_modules.app_utils.html#python_modules.app_utils._list_xlets_dirs">[docs]</a><span class="k">def</span> <span class="nf">_list_xlets_dirs</span><span class="p">(</span><span class="n">xlet_type_subdir</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get list of xlets directories for an xlet type.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    xlet_type_subdir : str</span>
<span class="sd">        The repository sub directory for an xlet type.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    list</span>
<span class="sd">        The list of xlet directory names.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root_folder</span><span class="p">,</span> <span class="n">xlet_type_subdir</span><span class="p">))</span></div>


<div class="viewcode-block" id="get_xlets_dirs"><a class="viewcode-back" href="../../modules/python_modules/python_modules.app_utils.html#python_modules.app_utils.get_xlets_dirs">[docs]</a><span class="k">def</span> <span class="nf">get_xlets_dirs</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Get xlets dirs.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    list</span>
<span class="sd">        The list of xlets directory names prefixed with their &quot;types&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">applets_dirs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Applet </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">_list_xlets_dirs</span><span class="p">(</span><span class="s2">&quot;applets&quot;</span><span class="p">)]</span>
    <span class="n">extensions_dirs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Extension </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">_list_xlets_dirs</span><span class="p">(</span><span class="s2">&quot;extensions&quot;</span><span class="p">)]</span>

    <span class="k">return</span> <span class="n">applets_dirs</span> <span class="o">+</span> <span class="n">extensions_dirs</span></div>


<div class="viewcode-block" id="validate_themes_options"><a class="viewcode-back" href="../../modules/python_modules/python_modules.app_utils.html#python_modules.app_utils.validate_themes_options">[docs]</a><span class="k">def</span> <span class="nf">validate_themes_options</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Validate themes options.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : str</span>
<span class="sd">        The entered option to validate.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    str</span>
<span class="sd">        The validated option.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    exceptions.ValidationError</span>
<span class="sd">        Halt execution if option is not valid.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span> <span class="ow">or</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="n">exceptions</span><span class="o">.</span><span class="n">ValidationError</span><span class="p">(</span><span class="s1">&#39;Posible options are &quot;1&quot; or &quot;2&quot;.&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">x</span></div>


<div class="viewcode-block" id="build_themes"><a class="viewcode-back" href="../../modules/python_modules/python_modules.app_utils.html#python_modules.app_utils.build_themes">[docs]</a><span class="k">def</span> <span class="nf">build_themes</span><span class="p">(</span><span class="n">theme_name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">build_output</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">do_not_cofirm</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">from_menu</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Build themes.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    theme_name : str, optional</span>
<span class="sd">        The given name of the theme.</span>
<span class="sd">    build_output : str, optional</span>
<span class="sd">        Path to the destination folder were the built themes will be saved.</span>
<span class="sd">    do_not_cofirm : bool, optional</span>
<span class="sd">        Whether to ask for overwrite confirmation when a theme destination exists or not.</span>
<span class="sd">    logger : object</span>
<span class="sd">        See &lt;class :any:`LogSystem`&gt;.</span>
<span class="sd">    from_menu : bool, optional</span>
<span class="sd">        Whether this function was called from the CLI menu or not.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    SystemExit</span>
<span class="sd">        Halt execution if the theme name cannot be obtained.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">options_map</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;cinnamon_version&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;1&quot;</span><span class="p">:</span> <span class="s2">&quot;3.0&quot;</span><span class="p">,</span>
            <span class="s2">&quot;2&quot;</span><span class="p">:</span> <span class="s2">&quot;3.4&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;gtk3_version&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;1&quot;</span><span class="p">:</span> <span class="s2">&quot;3.18&quot;</span><span class="p">,</span>
            <span class="s2">&quot;2&quot;</span><span class="p">:</span> <span class="s2">&quot;3.22&quot;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="n">options_map_defaults</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;cinnamon_version&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cinnamon_font_size&quot;</span><span class="p">:</span> <span class="s2">&quot;9pt&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cinnamon_font_family&quot;</span><span class="p">:</span> <span class="s1">&#39;&quot;Noto Sans&quot;, sans, Sans-Serif&#39;</span><span class="p">,</span>
        <span class="s2">&quot;gtk3_version&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span>
    <span class="p">}</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">Ansi</span><span class="o">.</span><span class="n">PURPLE</span><span class="p">(</span><span class="s2">&quot;Choose in which Cinnamon version the theme will be used.&quot;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">Ansi</span><span class="o">.</span><span class="n">PURPLE</span><span class="p">(</span><span class="s2">&quot;1. 3.0.x to 3.2.x (Default)&quot;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">Ansi</span><span class="o">.</span><span class="n">PURPLE</span><span class="p">(</span><span class="s2">&quot;2. 3.4.x to 3.8.x&quot;</span><span class="p">))</span>

    <span class="n">prompts</span><span class="o">.</span><span class="n">do_prompt</span><span class="p">(</span><span class="n">options_map_defaults</span><span class="p">,</span> <span class="s2">&quot;cinnamon_version&quot;</span><span class="p">,</span> <span class="s2">&quot;Enter an option&quot;</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
                      <span class="n">validator</span><span class="o">=</span><span class="n">validate_themes_options</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">Ansi</span><span class="o">.</span><span class="n">PURPLE</span><span class="p">(</span><span class="s2">&quot;Set the Cinnamon theme font size.&quot;</span><span class="p">))</span>

    <span class="n">prompts</span><span class="o">.</span><span class="n">do_prompt</span><span class="p">(</span><span class="n">options_map_defaults</span><span class="p">,</span> <span class="s2">&quot;cinnamon_font_size&quot;</span><span class="p">,</span> <span class="s2">&quot;Enter a value&quot;</span><span class="p">,</span> <span class="s2">&quot;9pt&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">Ansi</span><span class="o">.</span><span class="n">PURPLE</span><span class="p">(</span><span class="s2">&quot;Set the Cinnamon theme font family.&quot;</span><span class="p">))</span>

    <span class="n">prompts</span><span class="o">.</span><span class="n">do_prompt</span><span class="p">(</span><span class="n">options_map_defaults</span><span class="p">,</span> <span class="s2">&quot;cinnamon_font_family&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;Enter a value&quot;</span><span class="p">,</span> <span class="s1">&#39;&quot;Noto Sans&quot;, sans, Sans-Serif&#39;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">Ansi</span><span class="o">.</span><span class="n">PURPLE</span><span class="p">(</span><span class="s2">&quot;Choose in which Gtk+ version the theme will be used.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">Ansi</span><span class="o">.</span><span class="n">PURPLE</span><span class="p">(</span><span class="s2">&quot;1. 3.18.x (Default)&quot;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">Ansi</span><span class="o">.</span><span class="n">PURPLE</span><span class="p">(</span><span class="s2">&quot;2. 3.22.x&quot;</span><span class="p">))</span>

    <span class="n">prompts</span><span class="o">.</span><span class="n">do_prompt</span><span class="p">(</span><span class="n">options_map_defaults</span><span class="p">,</span> <span class="s2">&quot;gtk3_version&quot;</span><span class="p">,</span> <span class="s2">&quot;Enter an option&quot;</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
                      <span class="n">validator</span><span class="o">=</span><span class="n">validate_themes_options</span><span class="p">)</span>

    <span class="n">theme_data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;cinnamon_version&quot;</span><span class="p">:</span> <span class="n">options_map</span><span class="p">[</span><span class="s2">&quot;cinnamon_version&quot;</span><span class="p">][</span><span class="n">options_map_defaults</span><span class="p">[</span><span class="s2">&quot;cinnamon_version&quot;</span><span class="p">]],</span>
        <span class="s2">&quot;cinnamon_font_size&quot;</span><span class="p">:</span> <span class="n">options_map_defaults</span><span class="p">[</span><span class="s2">&quot;cinnamon_font_size&quot;</span><span class="p">],</span>
        <span class="s2">&quot;cinnamon_font_family&quot;</span><span class="p">:</span> <span class="n">options_map_defaults</span><span class="p">[</span><span class="s2">&quot;cinnamon_font_family&quot;</span><span class="p">],</span>
        <span class="s2">&quot;gtk3_version&quot;</span><span class="p">:</span> <span class="n">options_map</span><span class="p">[</span><span class="s2">&quot;gtk3_version&quot;</span><span class="p">][</span><span class="n">options_map_defaults</span><span class="p">[</span><span class="s2">&quot;gtk3_version&quot;</span><span class="p">]]</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">theme_name</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">theme_name_storage_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;UTF-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">theme_file</span><span class="p">:</span>
                <span class="n">theme_name</span> <span class="o">=</span> <span class="n">theme_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">Ansi</span><span class="o">.</span><span class="n">WARNING</span><span class="p">(</span><span class="n">missing_theme_name_msg</span><span class="p">))</span>
            <span class="k">raise</span> <span class="ne">SystemExit</span><span class="p">()</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">theme_name</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">Ansi</span><span class="o">.</span><span class="n">WARNING</span><span class="p">(</span><span class="n">missing_theme_name_msg</span><span class="p">))</span>
        <span class="k">raise</span> <span class="ne">SystemExit</span><span class="p">()</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">build_output</span><span class="p">:</span>
        <span class="n">base_output_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">get_base_temp_folder</span><span class="p">(),</span>
                                        <span class="n">misc_utils</span><span class="o">.</span><span class="n">micro_to_milli</span><span class="p">(</span><span class="n">misc_utils</span><span class="o">.</span><span class="n">get_date_time</span><span class="p">(</span><span class="s2">&quot;filename&quot;</span><span class="p">)))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">base_output_path</span> <span class="o">=</span> <span class="n">build_output</span>

    <span class="n">themes_sources</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root_folder</span><span class="p">,</span> <span class="s2">&quot;themes&quot;</span><span class="p">)</span>
    <span class="n">common_version_insensitive_files</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="n">themes_sources</span><span class="p">,</span> <span class="s2">&quot;_common&quot;</span><span class="p">,</span> <span class="s2">&quot;_version_insensitive&quot;</span><span class="p">)</span>
    <span class="n">common_version_sensitive</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">themes_sources</span><span class="p">,</span> <span class="s2">&quot;_common&quot;</span><span class="p">,</span> <span class="s2">&quot;_version_sensitive&quot;</span><span class="p">)</span>
    <span class="n">common_version_sensitive_cinnamon_files</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="n">common_version_sensitive</span><span class="p">,</span> <span class="s2">&quot;cinnamon&quot;</span><span class="p">,</span> <span class="n">theme_data</span><span class="p">[</span><span class="s2">&quot;cinnamon_version&quot;</span><span class="p">])</span>
    <span class="n">common_version_sensitive_gtk3_files</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="n">common_version_sensitive</span><span class="p">,</span> <span class="s2">&quot;gtk-3.0&quot;</span><span class="p">,</span> <span class="n">theme_data</span><span class="p">[</span><span class="s2">&quot;gtk3_version&quot;</span><span class="p">])</span>
    <span class="n">theme_variants</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">themes_sources</span><span class="p">,</span> <span class="s2">&quot;_variants&quot;</span><span class="p">))</span>

    <span class="kn">from</span> <span class="nn">runpy</span> <span class="k">import</span> <span class="n">run_path</span>

    <span class="k">for</span> <span class="n">variant</span> <span class="ow">in</span> <span class="n">theme_variants</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Generating variant: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">variant</span><span class="p">)</span>

        <span class="n">full_theme_name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">-</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">theme_name</span><span class="p">,</span> <span class="n">variant</span><span class="p">)</span>

        <span class="n">destination_folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_output_path</span><span class="p">,</span> <span class="n">full_theme_name</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">destination_folder</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">Ansi</span><span class="o">.</span><span class="n">ERROR</span><span class="p">(</span><span class="s2">&quot;InvalidDestination: Destination exists and is a file!!! Aborted!!!&quot;</span><span class="p">))</span>
            <span class="k">raise</span> <span class="ne">SystemExit</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">destination_folder</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">do_not_cofirm</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">Ansi</span><span class="o">.</span><span class="n">WARNING</span><span class="p">(</span><span class="n">existent_xlet_destination_msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">destination_folder</span><span class="p">)))</span>

            <span class="k">if</span> <span class="n">do_not_cofirm</span> <span class="ow">or</span> <span class="n">prompts</span><span class="o">.</span><span class="n">confirm</span><span class="p">(</span><span class="n">prompt</span><span class="o">=</span><span class="s2">&quot;Proceed?&quot;</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
                <span class="n">rmtree</span><span class="p">(</span><span class="n">destination_folder</span><span class="p">,</span> <span class="n">ignore_errors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">Ansi</span><span class="o">.</span><span class="n">ERROR</span><span class="p">(</span><span class="s2">&quot;OperationAborted: The theme building process was canceled.&quot;</span><span class="p">))</span>
                <span class="k">raise</span> <span class="ne">SystemExit</span><span class="p">()</span>

        <span class="n">variant_folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">themes_sources</span><span class="p">,</span> <span class="s2">&quot;_variants&quot;</span><span class="p">,</span> <span class="n">variant</span><span class="p">)</span>
        <span class="n">variant_config</span> <span class="o">=</span> <span class="n">run_path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">variant_folder</span><span class="p">,</span> <span class="s2">&quot;config.py&quot;</span><span class="p">))[</span><span class="s2">&quot;settings&quot;</span><span class="p">]</span>
        <span class="n">variant_config</span><span class="p">[</span><span class="s2">&quot;replacement_data&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s2">&quot;@repo_url@&quot;</span><span class="p">,</span> <span class="n">repo_url</span><span class="p">))</span>
        <span class="n">variant_config</span><span class="p">[</span><span class="s2">&quot;replacement_data&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s2">&quot;@theme_name@&quot;</span><span class="p">,</span> <span class="n">theme_name</span><span class="p">))</span>
        <span class="n">variant_config</span><span class="p">[</span><span class="s2">&quot;replacement_data&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s2">&quot;@theme_variant@&quot;</span><span class="p">,</span> <span class="n">variant</span><span class="p">))</span>
        <span class="n">variant_config</span><span class="p">[</span><span class="s2">&quot;replacement_data&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="p">(</span><span class="s1">&#39;&quot;@font_size@&quot;&#39;</span><span class="p">,</span> <span class="n">theme_data</span><span class="p">[</span><span class="s2">&quot;cinnamon_font_size&quot;</span><span class="p">]))</span>
        <span class="n">variant_config</span><span class="p">[</span><span class="s2">&quot;replacement_data&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="p">(</span><span class="s1">&#39;&quot;@font_family@&quot;&#39;</span><span class="p">,</span> <span class="n">theme_data</span><span class="p">[</span><span class="s2">&quot;cinnamon_font_family&quot;</span><span class="p">]))</span>
        <span class="n">variant_version_insensitive_files</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">variant_folder</span><span class="p">,</span> <span class="s2">&quot;_version_insensitive&quot;</span><span class="p">)</span>
        <span class="n">variant_version_sensitive</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">variant_folder</span><span class="p">,</span> <span class="s2">&quot;_version_sensitive&quot;</span><span class="p">)</span>
        <span class="n">variant_version_sensitive_cinnamon_files</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="n">variant_version_sensitive</span><span class="p">,</span> <span class="s2">&quot;cinnamon&quot;</span><span class="p">,</span> <span class="n">theme_data</span><span class="p">[</span><span class="s2">&quot;cinnamon_version&quot;</span><span class="p">])</span>
        <span class="n">variant_version_sensitive_gtk3_files</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="n">variant_version_sensitive</span><span class="p">,</span> <span class="s2">&quot;gtk-3.0&quot;</span><span class="p">,</span> <span class="n">theme_data</span><span class="p">[</span><span class="s2">&quot;gtk3_version&quot;</span><span class="p">])</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Copying files...&quot;</span><span class="p">)</span>
        <span class="n">file_utils</span><span class="o">.</span><span class="n">custom_copytree2</span><span class="p">(</span><span class="n">common_version_insensitive_files</span><span class="p">,</span> <span class="n">destination_folder</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">common_version_sensitive_cinnamon_files</span><span class="p">):</span>
            <span class="n">file_utils</span><span class="o">.</span><span class="n">custom_copytree2</span><span class="p">(</span><span class="n">common_version_sensitive_cinnamon_files</span><span class="p">,</span>
                                        <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">destination_folder</span><span class="p">,</span> <span class="s2">&quot;cinnamon&quot;</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">common_version_sensitive_gtk3_files</span><span class="p">):</span>
            <span class="n">file_utils</span><span class="o">.</span><span class="n">custom_copytree2</span><span class="p">(</span><span class="n">common_version_sensitive_gtk3_files</span><span class="p">,</span>
                                        <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">destination_folder</span><span class="p">,</span> <span class="s2">&quot;gtk-3.0&quot;</span><span class="p">))</span>

        <span class="n">file_utils</span><span class="o">.</span><span class="n">custom_copytree2</span><span class="p">(</span><span class="n">variant_version_insensitive_files</span><span class="p">,</span> <span class="n">destination_folder</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">variant_version_sensitive_gtk3_files</span><span class="p">):</span>
            <span class="n">file_utils</span><span class="o">.</span><span class="n">custom_copytree2</span><span class="p">(</span><span class="n">variant_version_sensitive_gtk3_files</span><span class="p">,</span>
                                        <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">destination_folder</span><span class="p">,</span> <span class="s2">&quot;gtk-3.0&quot;</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">variant_version_sensitive_cinnamon_files</span><span class="p">):</span>
            <span class="n">file_utils</span><span class="o">.</span><span class="n">custom_copytree2</span><span class="p">(</span><span class="n">variant_version_sensitive_cinnamon_files</span><span class="p">,</span>
                                        <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">destination_folder</span><span class="p">,</span> <span class="s2">&quot;cinnamon&quot;</span><span class="p">))</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Performing string substitutions...&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">dirs</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">destination_folder</span><span class="p">,</span> <span class="n">topdown</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">fname</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
                <span class="c1"># Only deal with a limited set of file extensions.</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">fname</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s2">&quot;.css&quot;</span><span class="p">,</span> <span class="s2">&quot;.svg&quot;</span><span class="p">,</span> <span class="s2">&quot;.xml&quot;</span><span class="p">,</span> <span class="s2">&quot;.json&quot;</span><span class="p">,</span> <span class="s2">&quot;.rc&quot;</span><span class="p">,</span>
                                       <span class="s2">&quot;gtkrc&quot;</span><span class="p">,</span> <span class="s2">&quot;.theme&quot;</span><span class="p">,</span> <span class="s2">&quot;.ini&quot;</span><span class="p">)):</span>
                    <span class="k">continue</span>

                <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">fname</span><span class="p">)</span>

                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;r+&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;UTF-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
                    <span class="n">file_data</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
                    <span class="n">file</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                    <span class="n">file_data_modified</span> <span class="o">=</span> <span class="n">string_utils</span><span class="o">.</span><span class="n">do_replacements</span><span class="p">(</span>
                        <span class="n">file_data</span><span class="p">,</span> <span class="n">variant_config</span><span class="p">[</span><span class="s2">&quot;replacement_data&quot;</span><span class="p">])</span>

                    <span class="k">if</span> <span class="n">file_data_modified</span> <span class="o">!=</span> <span class="n">file_data</span><span class="p">:</span>
                        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">file_data_modified</span><span class="p">)</span>
                        <span class="n">file</span><span class="o">.</span><span class="n">truncate</span><span class="p">()</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Theme variant </span><span class="si">%s</span><span class="s2"> succesfully built.&quot;</span> <span class="o">%</span> <span class="n">variant</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Built themes saved in </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">base_output_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="restart_cinnamon"><a class="viewcode-back" href="../../modules/python_modules/python_modules.app_utils.html#python_modules.app_utils.restart_cinnamon">[docs]</a><span class="k">def</span> <span class="nf">restart_cinnamon</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Restart Cinnamon.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">call</span><span class="p">(</span><span class="s2">&quot;nohup cinnamon --replace &gt; /dev/null 2&gt;&amp;1 &amp;&quot;</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>


<div class="viewcode-block" id="BaseXletGenerator"><a class="viewcode-back" href="../../modules/python_modules/python_modules.app_utils.html#python_modules.app_utils.BaseXletGenerator">[docs]</a><span class="k">class</span> <span class="nc">BaseXletGenerator</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Base xlet generator.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    base_xlet_path : str</span>
<span class="sd">        Path to the base application (the template).</span>
<span class="sd">    logger : object</span>
<span class="sd">        See &lt;class :any:`LogSystem`&gt;.</span>
<span class="sd">    new_xlet_destination : str</span>
<span class="sd">        The path to the new generated application.</span>
<span class="sd">    replacement_data : list</span>
<span class="sd">        List of tuples containing (template, replacement) data.</span>
<span class="sd">    xlet_data : dict</span>
<span class="sd">        Storage for xlet data that will be used to generate a base xlet.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">logger</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        logger : object</span>
<span class="sd">            See &lt;class :any:`LogSystem`&gt;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">BaseXletGenerator</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logger</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xlet_data</span> <span class="o">=</span> <span class="p">{}</span>

<div class="viewcode-block" id="BaseXletGenerator.generate"><a class="viewcode-back" href="../../modules/python_modules/python_modules.app_utils.html#python_modules.app_utils.BaseXletGenerator.generate">[docs]</a>    <span class="k">def</span> <span class="nf">generate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generate.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_do_setup</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_do_copy</span><span class="p">()</span>
        <span class="n">string_utils</span><span class="o">.</span><span class="n">do_string_substitutions</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">new_xlet_destination</span><span class="p">,</span>
                                             <span class="bp">self</span><span class="o">.</span><span class="n">replacement_data</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="p">)</span></div>

<div class="viewcode-block" id="BaseXletGenerator._do_setup"><a class="viewcode-back" href="../../modules/python_modules/python_modules.app_utils.html#python_modules.app_utils.BaseXletGenerator._do_setup">[docs]</a>    <span class="k">def</span> <span class="nf">_do_setup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Do setup.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        SystemExit</span>
<span class="sd">            Halt execution if the destination exists.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">prompt_data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;My Custom Xlet&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;My custom xlet description.&quot;</span><span class="p">,</span>
            <span class="s2">&quot;max_instances&quot;</span><span class="p">:</span> <span class="s2">&quot;-1&quot;</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="n">prompt_data_map</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;1&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;applet&quot;</span><span class="p">,</span>
                <span class="s2">&quot;manager&quot;</span><span class="p">:</span> <span class="s2">&quot;appletManager&quot;</span><span class="p">,</span>
                <span class="s2">&quot;files&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;applet.js&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;metadata.json&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;settings-schema.json&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;z_create_localized_help.py&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span>
            <span class="s2">&quot;2&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;extension&quot;</span><span class="p">,</span>
                <span class="s2">&quot;manager&quot;</span><span class="p">:</span> <span class="s2">&quot;extensionSystem&quot;</span><span class="p">,</span>
                <span class="s2">&quot;files&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;extension.js&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;metadata.json&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;z_create_localized_help.py&quot;</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="nb">print</span><span class="p">(</span><span class="n">Ansi</span><span class="o">.</span><span class="n">PURPLE</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Enter an xlet type:</span><span class="se">\n\n</span><span class="s2">1. applet</span><span class="se">\n</span><span class="s2">2. extension&quot;</span><span class="p">))</span>
        <span class="n">prompts</span><span class="o">.</span><span class="n">do_prompt</span><span class="p">(</span><span class="n">prompt_data</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;Choose an option&quot;</span><span class="p">,</span> <span class="n">prompt_data</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xlet_data</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">prompt_data_map</span><span class="p">[</span><span class="n">prompt_data</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]][</span><span class="s2">&quot;type&quot;</span><span class="p">]</span>

        <span class="nb">print</span><span class="p">(</span><span class="n">Ansi</span><span class="o">.</span><span class="n">PURPLE</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Enter a name for the xlet:&quot;</span><span class="p">))</span>
        <span class="n">prompts</span><span class="o">.</span><span class="n">do_prompt</span><span class="p">(</span><span class="n">prompt_data</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;Enter name&quot;</span><span class="p">,</span> <span class="n">prompt_data</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xlet_data</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">prompt_data</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>

        <span class="c1"># Define these here so I can check for existent destination immediately after the</span>
        <span class="c1"># xlet name is defined and exit if it already exists.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xlet_data</span><span class="p">[</span><span class="s2">&quot;slug&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;0&quot;</span> <span class="o">+</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">part</span><span class="o">.</span><span class="n">title</span><span class="p">()</span>
                                                <span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlet_data</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">base_xlet_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root_folder</span><span class="p">,</span> <span class="s2">&quot;__app__&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="s2">&quot;templates&quot;</span><span class="p">,</span> <span class="s2">&quot;BaseXlet&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">new_xlet_destination</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root_folder</span><span class="p">,</span>
                                                 <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">s&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlet_data</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">],</span>
                                                 <span class="bp">self</span><span class="o">.</span><span class="n">xlet_data</span><span class="p">[</span><span class="s2">&quot;slug&quot;</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">new_xlet_destination</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;ExistentLocation: New xlet cannot be created.&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">SystemExit</span><span class="p">()</span>

        <span class="nb">print</span><span class="p">(</span><span class="n">Ansi</span><span class="o">.</span><span class="n">PURPLE</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Enter a description for the xlet:&quot;</span><span class="p">))</span>
        <span class="n">prompts</span><span class="o">.</span><span class="n">do_prompt</span><span class="p">(</span><span class="n">prompt_data</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;Enter description&quot;</span><span class="p">,</span> <span class="n">prompt_data</span><span class="p">[</span><span class="s2">&quot;description&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xlet_data</span><span class="p">[</span><span class="s2">&quot;description&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">prompt_data</span><span class="p">[</span><span class="s2">&quot;description&quot;</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlet_data</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;extension&quot;</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">Ansi</span><span class="o">.</span><span class="n">PURPLE</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Enter max instances for the xlet:&quot;</span><span class="p">))</span>
            <span class="n">prompts</span><span class="o">.</span><span class="n">do_prompt</span><span class="p">(</span><span class="n">prompt_data</span><span class="p">,</span> <span class="s2">&quot;max_instances&quot;</span><span class="p">,</span>
                              <span class="s2">&quot;Enter description&quot;</span><span class="p">,</span> <span class="n">prompt_data</span><span class="p">[</span><span class="s2">&quot;max_instances&quot;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xlet_data</span><span class="p">[</span><span class="s2">&quot;max_instances&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">prompt_data</span><span class="p">[</span><span class="s2">&quot;max_instances&quot;</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">xlet_data</span><span class="p">[</span><span class="s2">&quot;manager&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">prompt_data_map</span><span class="p">[</span><span class="n">prompt_data</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]][</span><span class="s2">&quot;manager&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xlet_data</span><span class="p">[</span><span class="s2">&quot;files&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">prompt_data_map</span><span class="p">[</span><span class="n">prompt_data</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]][</span><span class="s2">&quot;files&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xlet_data</span><span class="p">[</span><span class="s2">&quot;type_title_case&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">prompt_data</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">title</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">replacement_data</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="s2">&quot;$$XLET_NAME$$&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlet_data</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]),</span>
            <span class="p">(</span><span class="s2">&quot;$$XLET_DESCRIPTION$$&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlet_data</span><span class="p">[</span><span class="s2">&quot;description&quot;</span><span class="p">]),</span>
            <span class="p">(</span><span class="s2">&quot;$$XLET_MANAGER$$&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlet_data</span><span class="p">[</span><span class="s2">&quot;manager&quot;</span><span class="p">]),</span>
            <span class="p">(</span><span class="s2">&quot;$$XLET_TYPE$$&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlet_data</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]),</span>
            <span class="p">(</span><span class="s2">&quot;$$XLET_TYPE_TITLE_CASE$$&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlet_data</span><span class="p">[</span><span class="s2">&quot;type_title_case&quot;</span><span class="p">]),</span>
        <span class="p">]</span></div>

<div class="viewcode-block" id="BaseXletGenerator._do_copy"><a class="viewcode-back" href="../../modules/python_modules/python_modules.app_utils.html#python_modules.app_utils.BaseXletGenerator._do_copy">[docs]</a>    <span class="k">def</span> <span class="nf">_do_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Do copy.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">new_xlet_destination</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Copying files...&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">file_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlet_data</span><span class="p">[</span><span class="s2">&quot;files&quot;</span><span class="p">]:</span>
            <span class="n">copy2</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_xlet_path</span><span class="p">,</span> <span class="n">file_name</span><span class="p">),</span>
                  <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">new_xlet_destination</span><span class="p">,</span> <span class="n">file_name</span><span class="p">))</span></div></div>


<div class="viewcode-block" id="generate_docs"><a class="viewcode-back" href="../../modules/python_modules/python_modules.app_utils.html#python_modules.app_utils.generate_docs">[docs]</a><span class="k">def</span> <span class="nf">generate_docs</span><span class="p">(</span><span class="n">generate_api_docs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                  <span class="n">update_inventories</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                  <span class="n">force_clean_build</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                  <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;See :any:`sphinx_docs_utils.generate_docs`</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    generate_api_docs : bool, optional</span>
<span class="sd">        See :any:`sphinx_docs_utils.generate_docs`.</span>
<span class="sd">    update_inventories : bool, optional</span>
<span class="sd">        See :any:`sphinx_docs_utils.generate_docs`.</span>
<span class="sd">    force_clean_build : bool, optional</span>
<span class="sd">        See :any:`sphinx_docs_utils.generate_docs`.</span>
<span class="sd">    logger : None, optional</span>
<span class="sd">        See :any:`LogSystem`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">.python_utils</span> <span class="k">import</span> <span class="n">sphinx_docs_utils</span>

    <span class="n">sphinx_docs_utils</span><span class="o">.</span><span class="n">generate_docs</span><span class="p">(</span><span class="n">root_folder</span><span class="o">=</span><span class="n">root_folder</span><span class="p">,</span>
                                    <span class="n">apidoc_src_path_rel_to_root</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                                        <span class="s2">&quot;__app__&quot;</span><span class="p">,</span> <span class="s2">&quot;python_modules&quot;</span><span class="p">),</span>
                                    <span class="n">apidoc_dest_path_rel_to_root</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                                        <span class="s2">&quot;__app__&quot;</span><span class="p">,</span> <span class="s2">&quot;docs_sources&quot;</span><span class="p">,</span> <span class="s2">&quot;modules&quot;</span><span class="p">,</span> <span class="s2">&quot;python_modules&quot;</span><span class="p">),</span>
                                    <span class="n">doctree_temp_location_rel_to_sys_temp</span><span class="o">=</span><span class="s2">&quot;CinnamonTools-doctrees&quot;</span><span class="p">,</span>
                                    <span class="n">ignored_modules</span><span class="o">=</span><span class="n">ignored_apidoc_modules</span><span class="p">,</span>
                                    <span class="n">generate_api_docs</span><span class="o">=</span><span class="n">generate_api_docs</span><span class="p">,</span>
                                    <span class="n">update_inventories</span><span class="o">=</span><span class="n">update_inventories</span><span class="p">,</span>
                                    <span class="n">force_clean_build</span><span class="o">=</span><span class="n">force_clean_build</span><span class="p">,</span>
                                    <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span></div>


<div class="viewcode-block" id="get_base_temp_folder"><a class="viewcode-back" href="../../modules/python_modules/python_modules.app_utils.html#python_modules.app_utils.get_base_temp_folder">[docs]</a><span class="k">def</span> <span class="nf">get_base_temp_folder</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Get base temporary directory.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    str</span>
<span class="sd">        Path to a temporary folder.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">misc_utils</span><span class="o">.</span><span class="n">get_system_tempdir</span><span class="p">(),</span> <span class="s2">&quot;CinnamonToolsTemp&quot;</span><span class="p">)</span></div>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="k">pass</span>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016-2018, Odyseus.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a modified version of <a href="https://github.com/rtfd/sphinx_rtd_theme">sphinx-rtd-theme</a>. 

</footer>

        </div>
      </div>

      <a id="to-top-of-page" href="#top">
        <i class="fa fa-chevron-circle-up"></i>
      </a>

    </section>

  </div>

  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  <script type="text/javascript" src="../../_static/js/theme.min.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>